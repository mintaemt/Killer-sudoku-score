@tailwind base;
@tailwind components;
@tailwind utilities;

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {

  /* Fallback: 預設使用 dark 模式，除非明確設定為 light */
  :root {
    /* Dark mode colors as default fallback */
    --background: 0 0% 10%;
    --foreground: 0 0% 95%;

    --card: 0 0% 13%;
    --card-foreground: 0 0% 95%;

    --popover: 0 0% 13%;
    --popover-foreground: 0 0% 95%;

    --primary: 211 100% 50%;
    --primary-foreground: 0 0% 100%;

    --secondary: 0 0% 18%;
    --secondary-foreground: 0 0% 95%;

    --muted: 0 0% 18%;
    --muted-foreground: 0 0% 60%;

    --accent: 211 100% 50%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 100% 67%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 25%;
    --input: 0 0% 25%;
    --ring: 211 100% 50%;

    --cell-bg: 0 0% 15%;
    --cell-selected: 211 50% 20%;
    --cell-highlighted: 211 30% 18%;
    --cell-error: 0 50% 20%;
    --cell-given: 0 0% 18%;
    --cage-border: 0 0% 18%;
    --cage-sum: 0 0% 60%;
    /* Mobile: Thinner Border (1px for safe rendering) */
    --cage-border-width: 1px;

    --radius: 0.75rem;

    --dopamine-bg: #1a1a1a;
    /* Dark Mode: Soft Dark Base */
    --dopamine-filter: saturate(1.5) contrast(1.1);
    /* Standard Richness */

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  }

  /* Light mode override */
  .light {
    /* Apple-inspired color palette */
    --background: 0 0% 98%;
    --foreground: 0 0% 13%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 13%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 13%;

    /* Default Blue theme */
    --primary: 211 100% 50%;
    --primary-foreground: 0 0% 100%;

    --secondary: 0 0% 96%;
    --secondary-foreground: 0 0% 13%;

    --muted: 0 0% 95%;
    --muted-foreground: 0 0% 45%;

    --accent: 211 100% 50%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 100% 67%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 88%;
    --input: 0 0% 92%;
    --ring: 211 100% 50%;

    /* Sudoku-specific colors */
    --cell-bg: 0 0% 100%;
    --cell-selected: 211 100% 92%;
    --cell-highlighted: 211 100% 95%;
    --cell-error: 0 100% 92%;
    --cell-given: 0 0% 97%;

    /* Light Mode Cage Border: 35% Gray (Darker) */
    --cage-border: 0 0% 35%;
    --cage-sum: 0 0% 60%;

    --dopamine-bg: #000000;
    /* Light Mode: Deep Black */
    --dopamine-filter: saturate(2.0) contrast(1.1) brightness(1.0);
    /* Light Mode: Tuned Vivid (2.0/1.1/1.0) */
  }

  /* Theme variations */
  html[data-theme="orange"] {
    --primary: 25 100% 50%;
    --accent: 25 100% 50%;
    --ring: 25 100% 50%;
    --cell-selected: 25 100% 92%;
    --cell-highlighted: 25 100% 95%;
  }

  html[data-theme="lime"] {
    /* Nike Volt Style Lime - Updated to #BFFF00 */
    --primary: 74 100% 50%;
    --primary-foreground: 0 0% 18%;
    /* Dark Text for Light Background */
    --accent: 74 100% 50%;
    --accent-foreground: 0 0% 18%;
    /* Ensuring Hover Text is also Dark */
    --ring: 74 100% 50%;
    --cell-selected: 74 100% 92%;
    --cell-highlighted: 74 100% 95%;
  }

  html[data-theme="purple"] {
    --primary: 262 83% 58%;
    --accent: 262 83% 58%;
    --ring: 262 83% 58%;
    --cell-selected: 262 100% 92%;
    --cell-highlighted: 262 100% 95%;
  }

  html[data-theme="pink"] {
    --primary: 330 81% 60%;
    --accent: 330 81% 60%;
    --ring: 330 81% 60%;
    --cell-selected: 330 100% 92%;
    --cell-highlighted: 330 100% 95%;
  }

  html[data-theme="teal"] {
    --primary: 173 80% 40%;
    --accent: 173 80% 40%;
    --ring: 173 80% 40%;
    --cell-selected: 173 100% 92%;
    --cell-highlighted: 173 100% 95%;
  }

  /* Dark mode theme variations */
  .dark [data-theme="orange"] {
    --cell-selected: 25 50% 20%;
    --cell-highlighted: 25 30% 18%;
  }

  .dark [data-theme="red"] {
    --cell-selected: 0 50% 20%;
    --cell-highlighted: 0 30% 18%;
  }

  .dark [data-theme="lime"] {
    --cell-selected: 80 50% 20%;
    --cell-highlighted: 80 30% 18%;
  }

  .dark [data-theme="purple"] {
    --cell-selected: 262 50% 20%;
    --cell-highlighted: 262 30% 18%;
  }

  .dark [data-theme="pink"] {
    --cell-selected: 330 50% 20%;
    --cell-highlighted: 330 30% 18%;
  }

  .dark [data-theme="teal"] {
    --cell-selected: 173 50% 20%;
    --cell-highlighted: 173 30% 18%;
  }

  .dark {
    --background: 0 0% 10%;
    --foreground: 0 0% 95%;

    --card: 0 0% 13%;
    --card-foreground: 0 0% 95%;

    --popover: 0 0% 13%;
    --popover-foreground: 0 0% 95%;

    --primary: 211 100% 50%;
    --primary-foreground: 0 0% 100%;

    --secondary: 0 0% 18%;
    --secondary-foreground: 0 0% 95%;

    --muted: 0 0% 18%;
    --muted-foreground: 0 0% 60%;

    --accent: 211 100% 50%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 100% 67%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 25%;
    --input: 0 0% 25%;
    --ring: 211 100% 50%;

    --cell-bg: 0 0% 15%;
    --cell-selected: 211 50% 20%;
    --cell-highlighted: 211 30% 18%;
    --cell-error: 0 50% 20%;
    --cell-given: 0 0% 18%;
    /* Dark Mode Cage Border: 85% Gray (Whiter) */
    --cage-border: 0 0% 85%;
    --cage-sum: 0 0% 60%;
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-transparent text-foreground;
    font-family: 'Huninn', sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

@layer utilities {
  .glass {
    @apply bg-white/80 backdrop-blur-xl;
  }

  .dark .glass {
    @apply bg-black/60 backdrop-blur-xl;
  }

  .transition-smooth {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Ensure dropdowns appear above all other elements and don't affect layout */
  .dropdown-menu {
    @apply z-[9999] !important;
    position: absolute !important;
    /* Ensure dropdown doesn't affect parent container height */
    transform: translateZ(0);
    will-change: transform;
  }

  /* Advanced Liquid Glass effect for dropdowns */
  .dropdown-glass {
    position: relative;
    overflow: visible;

    /* 玻璃主體：更強的背景色 + 背景模糊 + 邊框/陰影 */
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.7);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    backdrop-filter: blur(15px) saturate(150%);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.5),
      0 24px 60px rgba(0, 0, 0, 0.2);
    border-radius: 18px;
  }

  /* 內部"液體"——多重逕向漸變緩慢位移，營造流動與折射 */
  .dropdown-glass::before {
    content: "";
    position: absolute;
    inset: -10%;
    background:
      radial-gradient(180px 140px at 20% 30%, rgba(255, 255, 255, 0.25), transparent 60%),
      radial-gradient(220px 160px at 80% 40%, rgba(255, 255, 255, 0.18), transparent 65%),
      radial-gradient(320px 200px at 40% 85%, rgba(255, 255, 255, 0.12), transparent 70%);
    filter: blur(18px) saturate(140%);
    animation: drift 12s ease-in-out infinite alternate;
    pointer-events: none;
    z-index: -1;
  }

  /* 斜向高光條 */
  .dropdown-glass::after {
    content: "";
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    background:
      linear-gradient(110deg,
        rgba(255, 255, 255, 0.28) 0%,
        rgba(255, 255, 255, 0) 40% 60%,
        rgba(255, 255, 255, 0.16) 100%);
    mix-blend-mode: screen;
    pointer-events: none;
    z-index: -1;
  }

  .dark .dropdown-glass {
    /* 深色模式的玻璃主體 - 更強的背景色 */
    background: rgba(0, 0, 0, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.4);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    backdrop-filter: blur(15px) saturate(150%);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.3),
      0 24px 60px rgba(0, 0, 0, 0.3);
  }

  .dark .dropdown-glass::before {
    background:
      radial-gradient(180px 140px at 20% 30%, rgba(255, 255, 255, 0.12), transparent 60%),
      radial-gradient(220px 160px at 80% 40%, rgba(255, 255, 255, 0.1), transparent 65%),
      radial-gradient(320px 200px at 40% 85%, rgba(255, 255, 255, 0.08), transparent 70%);
  }

  .dark .dropdown-glass::after {
    background:
      linear-gradient(110deg,
        rgba(255, 255, 255, 0.18) 0%,
        rgba(255, 255, 255, 0) 40% 60%,
        rgba(255, 255, 255, 0.1) 100%);
  }

  /* 液體流動動畫 */
  @keyframes drift {
    0% {
      transform: translate(-2%, -3%) scale(1);
    }

    50% {
      transform: translate(3%, 2%) scale(1.03);
    }

    100% {
      transform: translate(-1%, 3%) scale(1.05);
    }
  }

  /* 移動裝置優化：增加下拉選單背景不透明度 */
  @media (max-width: 768px) {
    .dropdown-glass {
      background: rgba(255, 255, 255, 0.98) !important;
      border: 1px solid rgba(255, 255, 255, 0.8) !important;
      -webkit-backdrop-filter: blur(15px) saturate(180%) !important;
      backdrop-filter: blur(15px) saturate(180%) !important;
    }

    .dark .dropdown-glass {
      background: rgba(0, 0, 0, 0.98) !important;
      border: 1px solid rgba(255, 255, 255, 0.5) !important;
    }
  }

  /* 訪客模式按鈕自定義樣式 */
  .guest-mode-button {
    @apply border-gray-300 text-gray-600 hover:bg-gray-100 hover:text-gray-700;
    transition: all 0.2s ease-in-out;
  }

  .guest-mode-button:active {
    @apply bg-gray-200 text-gray-800;
    transform: translateY(1px);
  }

  .dark .guest-mode-button {
    @apply border-gray-600 text-gray-400 hover:bg-gray-800 hover:text-gray-300;
  }

  .dark .guest-mode-button:active {
    @apply bg-gray-700 text-gray-200;
  }

  /* Retro Pixel Font for Game Over */
  .retro-pixel-text {
    font-family: 'Pixelify Sans', 'Courier New', 'Monaco', 'Menlo', monospace;
    font-weight: 700;
    letter-spacing: 0.1em;
    /* 移除文字陰影，讓flowing-text效果正常顯示 */
  }

  /* Desktop Adjustments */
  @media (min-width: 768px) {
    :root {
      /* Desktop: Standard Thickness */
      --cage-border-width: 1.5px;
    }
  }

}

/* Glassmorphism 效果 */
.glassmorphism {
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow:
    0 8px 32px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.5),
    inset 0 -1px 0 rgba(255, 255, 255, 0.1),
    inset 0 0 14px 7px rgba(255, 255, 255, 0.7);
  position: relative;
  overflow: hidden;
}

.glassmorphism::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(90deg,
      transparent,
      rgba(255, 255, 255, 0.8),
      transparent);
}

.glassmorphism::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 1px;
  height: 100%;
  background: linear-gradient(180deg,
      rgba(255, 255, 255, 0.8),
      transparent,
      rgba(255, 255, 255, 0.3));
}

.dark .glassmorphism {
  background: rgba(0, 0, 0, 0.25);
  border: 1px solid rgba(255, 255, 255, 0.15);
}

.dark .glassmorphism::before {
  background: linear-gradient(90deg,
      transparent,
      rgba(255, 255, 255, 0.4),
      transparent);
}

.dark .glassmorphism::after {
  background: linear-gradient(180deg,
      rgba(255, 255, 255, 0.4),
      transparent,
      rgba(255, 255, 255, 0.1));
}

/* 流動漸層動畫 - 平滑隨機暈染流動 */
@keyframes gradient-flow {
  0% {
    background-position: 0% 0%;
  }

  100% {
    background-position: 200% 200%;
  }
}

.gradient-flow {
  background:
    linear-gradient(30deg,
      rgba(249, 115, 22, 0) 0%,
      rgba(249, 115, 22, 0.4) 5%,
      rgba(239, 68, 68, 0.35) 20%,
      rgba(34, 197, 94, 0.4) 35%,
      rgba(168, 85, 247, 0.35) 50%,
      rgba(236, 72, 153, 0.4) 65%,
      rgba(20, 184, 166, 0.35) 80%,
      rgba(249, 115, 22, 0.4) 95%,
      rgba(249, 115, 22, 0) 100%);
  background-size: 200% 200%;
  background-repeat: repeat;
  animation: gradient-flow 90s linear infinite;
}

/* 多巴胺資訊卡hover效果 - 使用四個主題顏色 */
@property --d1 {
  syntax: "<color>";
  inherits: true;
  initial-value: #FB923C;
  /* 更亮的橘色 */
}

@property --d2 {
  syntax: "<color>";
  inherits: true;
  initial-value: #60A5FA;
  /* 更亮的藍色 */
}

.d {
  background: linear-gradient(30deg, var(--d1), var(--d2));
}

.d:hover {
  animation: oxxo-d 1s infinite alternate;
}

@keyframes oxxo-d {
  0% {
    --d1: #FB923C;
    /* 更亮的橘色 */
    --d2: #60A5FA;
    /* 更亮的藍色 */
  }

  100% {
    --d1: #C084FC;
    /* 更亮的紫色 */
    --d2: #F472B6;
    /* 更亮的粉色 */
  }
}

/* Game Over 流動顏色效果 - 粉色和橘色搭配 */
.flowing-text {
  background: linear-gradient(90deg, #F472B6, #FB923C, #F472B6, #FB923C);
  background-size: 200% 100%;
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  animation: flowing-color 3s ease-in-out infinite;
}

/* Well Done 流動顏色效果 - 橘色和紫色搭配 */
.flowing-text-well-done {
  background: linear-gradient(90deg, #FB923C, #A855F7, #FB923C, #A855F7);
  background-size: 200% 100%;
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  animation: flowing-color-well-done 3s ease-in-out infinite;
}

@keyframes flowing-color {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

@keyframes flowing-color-well-done {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

/* 多巴胺資訊卡流動按鈕效果 - 藍、teal、紫、橘主題色 */
.flowing-button {
  position: relative;
  background: linear-gradient(45deg, #3B82F6, #14B8A6, #A855F7, #FB923C);
  background-size: 300% 300%;
  animation: flowing-button-bg 6s ease-in-out infinite;
  overflow: hidden;
}

.flowing-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
  animation: flowing-shine 8s ease-in-out infinite;
}

.flowing-button:hover::before {
  animation-duration: 3s;
}

@keyframes flowing-button-bg {
  0% {
    background-position: 0% 50%;
  }

  25% {
    background-position: 50% 0%;
  }

  50% {
    background-position: 100% 50%;
  }

  75% {
    background-position: 50% 100%;
  }

  100% {
    background-position: 0% 50%;
  }
}

@keyframes flowing-shine {
  0% {
    left: -100%;
  }

  50% {
    left: 100%;
  }

  100% {
    left: 100%;
  }

  100% {
    left: 100%;
  }
}

/* Dopamine Rich Aurora Animation (Favicon Drifting Glow) - 50% Richer */
/* Dopamine Rich Aurora Animation (Favicon Drifting Glow) - 50% Richer */
.btn-dopamine-animated {
  background: var(--dopamine-bg);
  position: relative;
  overflow: hidden;
  border: none !important;
  color: white !important;
  z-index: 1;
  /* Adaptive saturation/contrast for richness */
  filter: var(--dopamine-filter);
}

/* Layer 1: Cool Colors (Blue, Purple, Teal) - Full Background Swirl */
.btn-dopamine-animated::before {
  content: '';
  position: absolute;
  top: -150%;
  left: -150%;
  width: 400%;
  height: 400%;
  background: conic-gradient(from 180deg, #3b82f6, #a855f7, #14b8a6, #3b82f6);
  filter: blur(20px);
  opacity: 1.0;
  /* Max Opacity */
  animation: dopamine-aurora-drift 15s linear infinite reverse;
  z-index: -2;
}

/* Layer 2: Warm Colors (Orange, Pink, Lime) - Floating Petals (Top) */
.btn-dopamine-animated::after {
  content: '';
  position: absolute;
  top: -150%;
  left: -150%;
  width: 400%;
  height: 400%;
  /* Orange, Pink, Lime separated by transparent gaps */
  background: conic-gradient(from 0deg,
      transparent 0deg,
      #ff7710 40deg,
      transparent 100deg,
      #ec4899 160deg,
      transparent 220deg,
      #BFFF00 280deg,
      transparent 340deg);
  filter: blur(18px);
  /* Slightly less blur to keep intensity */
  opacity: 1.0;
  /* Max Opacity */
  mix-blend-mode: normal;
  animation: dopamine-aurora-drift 10s linear infinite;
  z-index: -1;
}

@keyframes dopamine-aurora-drift {
  0% {
    transform: rotate(0deg) translate(0, 0);
  }

  25% {
    transform: rotate(90deg) translate(8px, 8px);
  }

  50% {
    transform: rotate(180deg) translate(-5px, 12px);
  }

  75% {
    transform: rotate(270deg) translate(-8px, -5px);
  }

  100% {
    transform: rotate(360deg) translate(0, 0);
  }
}

/* Sci-Fi Holographic Button Styles */
.sci-fi-button {
  position: relative;
  background: rgba(15, 23, 42, 0.9);
  /* Dark Slate / Navy background */
  border: 1px solid rgba(56, 189, 248, 0.5);
  /* Sky Blue border */
  overflow: hidden;
  color: white;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 1;
  box-shadow: 0 0 15px rgba(56, 189, 248, 0.1);
  backdrop-filter: blur(4px);
}

/* Subtle Tech Grid Background Pattern */
.sci-fi-button::after {
  content: '';
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(56, 189, 248, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(56, 189, 248, 0.1) 1px, transparent 1px);
  background-size: 16px 16px;
  background-position: center;
  opacity: 0.3;
  z-index: -1;
  transition: opacity 0.3s ease;
}

/* Holographic Scanning Beam from Left to Right */
.sci-fi-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -150%;
  width: 50%;
  height: 100%;
  background: linear-gradient(90deg,
      transparent 0%,
      rgba(56, 189, 248, 0.1) 20%,
      /* Cyan/Blue */
      rgba(192, 132, 252, 0.6) 50%,
      /* Bright Purple */
      rgba(56, 189, 248, 0.1) 80%,
      /* Cyan/Blue */
      transparent 100%);
  transform: skewX(-25deg);
  animation: sci-fi-scan 4s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  z-index: -1;
  opacity: 0.8;
}

/* Hover Effects: Brighter Glow, Stonger Border, Text Spacing */
.sci-fi-button:hover {
  background: rgba(15, 23, 42, 0.95) !important;
  /* Ensure background stays dark/navy, ignoring theme colors */
  border-color: rgba(168, 85, 247, 0.8);
  /* Purple border */
  box-shadow:
    0 0 20px rgba(56, 189, 248, 0.4),
    0 0 40px rgba(168, 85, 247, 0.3),
    inset 0 0 15px rgba(56, 189, 248, 0.2);
  transform: translateY(-1px);
  letter-spacing: 0.05em;
  text-shadow: 0 0 8px rgba(192, 132, 252, 0.8);
}

.sci-fi-button:hover::after {
  opacity: 0.5;
  /* Grid becomes more visible */
}

.sci-fi-button:hover::before {
  animation-duration: 2s;
  /* Scan speeds up significantly on hover */
  opacity: 1;
}

/* Active Press Effect */
.sci-fi-button:active {
  transform: translateY(1px) scale(0.99);
  box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
}

/* Keyframes for the scanning beam */
@keyframes sci-fi-scan {
  0% {
    left: -100%;
    opacity: 0;
  }

  15% {
    opacity: 1;
  }

  85% {
    opacity: 1;
  }

  100% {
    left: 200%;
    opacity: 0;
  }
}